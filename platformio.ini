[platformio]
; Set the default environment to 'debug' for development.
; To build for release, use: pio run -e release
default_envs = debug

[env]
; -----------------------------------------------------------------------------
; COMMON SETTINGS - Shared across all environments
; -----------------------------------------------------------------------------
platform = espressif32@~6.0.1
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600

; --- Library Dependencies ---
lib_deps =
    pololu/VL53L0X@^1.3.1
    rfetick/MPU6050_light@^1.1.0
    bblanchon/ArduinoJson@^6.19.4
    ; 'wire' is part of the framework and does not need to be listed here.

; --- Filesystem & Partitions ---
; Using LittleFS is recommended over SPIFFS for better performance and wear-leveling.
board_build.filesystem = littlefs
; This partition scheme provides two OTA app slots and a large filesystem partition.
; app0: ~1.4MB, app1: ~1.4MB, littlefs: ~1MB
board_build.partitions = min_spiffs.csv

; --- OTA (Over-the-Air) Upload Settings ---
; upload_protocol = espota
; For convenience, you can set the IP address here or use an environment variable.
; upload_port = 192.168.1.123
; To use a password, uncomment the line below and set the password in your code.
; upload_flags = --auth=your_ota_password

; -----------------------------------------------------------------------------
; DEBUG ENVIRONMENT - For development
; -----------------------------------------------------------------------------
[env:debug]
; Inherit common settings from [env]
extends = env

; Enable verbose logging and colored output for easier debugging.
build_flags =
    -D CORE_DEBUG_LEVEL=4 ; 4=Info, 5=Debug
    -D CONFIG_ARDUHAL_LOG_COLORS=1


# Use serial upload for debug (wired flashing)
upload_protocol = esptool

; -----------------------------------------------------------------------------
; RELEASE ENVIRONMENT - For production/deployment
; -----------------------------------------------------------------------------
[env:release]
; Inherit common settings from [env]
extends = env

; Disable logging to save flash space and improve performance.
build_flags =
    -D CORE_DEBUG_LEVEL=0 ; 0=None

; You can add optimizations here if needed.
; build_unflags = -O2
; build_flags = -Os ; Optimize for size

# Use serial upload for release (wired flashing)
upload_protocol = esptool
# To use OTA upload for release (wireless flashing), comment the line above and uncomment below:
# upload_protocol = espota

; -----------------------------------------------------------------------------
; OTA ENVIRONMENT - For wireless firmware updates
; -----------------------------------------------------------------------------
[env:ota]
; Inherit all settings from the 'debug' environment
extends = env:debug

; --- OTA Upload Settings ---
; Use the OTA protocol instead of serial
upload_protocol = espota

; Set the robot's network details. Use the mDNS hostname for convenience.
 upload_port = 192.168.1.240

; Provide the password defined in credentials.h
upload_flags = --auth=080493